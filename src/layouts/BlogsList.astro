---
import config from "@/config/config.json";
import dateFormat from "@/lib/utils/dateFormat";
import { humanize, plainify, slugify } from "@/lib/utils/textConverter";

const { summary_length } = config.settings;
const { blogs } = Astro.props;
---

{
  blogs ? (
    <div class="space-y-8">
      {blogs.map((post: any) => (
        <article class="border-b border-gray-200 dark:border-gray-700 pb-6 last:border-0">
          <div>
            <h3 class="text-xl md:text-2xl font-bold mb-2">
              <a
                href={`/blog/${post.slug}`}
                class="hover:text-primary transition-colors duration-300"
              >
                {post.data.title}
              </a>
            </h3>
            <div class="flex items-center text-sm text-gray-500 dark:text-gray-400 mb-3">
              <span class="flex items-center mr-4">
                <i class="ti ti-calendar-month mr-1 h-4 w-4 shrink-0" />
                {dateFormat(post.data.date)}
              </span>
              {post.data.tags && (
                <span class="flex items-center flex-wrap">
                  <i class="ti ti-hash mr-1 h-4 w-4 shrink-0" />
                  {post.data.tags.map(
                    (tag: string, index: number) => (
                      <span class="mr-1">
                        <a
                          href={`/blog/t/${slugify(tag)}`}
                          class="hover:text-primary"
                        >
                          {humanize(tag)}
                        </a>
                        {index < post.data.tags.length - 1 && ", "}
                      </span>
                    ),
                  )}
                </span>
              )}
            </div>
            <p class="text-gray-700 dark:text-gray-300 text-base">
              {post.data.description ??
                plainify(
                  `${post.body?.slice(0, Number(summary_length))} ...`,
                )}
            </p>
            <a
              href={`/blog/${post.slug}`}
              class="inline-block mt-3 text-primary font-medium text-sm hover:underline"
            >
              Weiterlesen â†’
            </a>
          </div>
        </article>
      ))}
    </div>
  ) : (
    <p class="text-center">Keine Blogs gefunden :(</p>
  )
}
